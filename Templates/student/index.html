{% extends '../base.html' %}
{% block title %}Students{% endblock %}
{% block register_login %}
<ul class="navbar-nav">
  {% if student.is_authenticated %}
  <li class="nav-item">
    <a class="nav-link" href="{% url 'student:logout' %}">Logout</a>
  </li>
  {% else %}
  <li class="nav-item">
    <a class="nav-link" href="{% url 'student:register' %}">Register</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="{% url 'student:login' %}">Login </a>
  </li>
  {% endif %}
</ul>
{% endblock %}
{% block main_section %}
{% if student.is_authenticated %}
<section style="background-color: #eee">
  <h1 style="text-align: center; padding-top: 50px">Student Details</h1>
  <div class="container py-5">
    <div class="row">
      <div class="col-lg-4">
        <div class="card mb-4">
          <div class="card-body text-center">
            <img
              src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava3.webp"
              alt="avatar"
              class="rounded-circle img-fluid"
              style="width: 150px"
            />
            <h5 class="my-3">{{ student.student.name }}</h5>
          </div>
        </div>
      </div>
      <div class="col-lg-8">
        <div class="card mb-4">
          <div class="card-body">
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Full Name</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0">{{ student.student.name }}</p>
              </div>
            </div>
            <hr />
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Email</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0">{{ student.student.email }}</p>
              </div>
            </div>
            <hr />
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Phone</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0">{{ student.student.phone }}</p>
              </div>
            </div>
            <hr />
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">CV</p>
              </div>
              {% if student.student.cv != "" %}
              <div class="col-sm-4">
                <p class="text-muted mb-0">CV Uploaded</p>
              </div>
              <a href="{{cv_path}}" target="_blank" style="margin-right: 20px">View CV</a>
              <a href="{{cv_path}}" download>Download CV</a>
              {% else %}
              <div class="col-sm-9">
                <p class="text-muted mb-0">No CV uploaded</p>
              </div>
              {% endif %}
            </div>
            <hr />
            {% if student.student.cv == "" %}
            <form enctype="multipart/form-data" method="post">
              {% csrf_token %}
              <input type="file" name="cv" />
              <button type="submit" class="btn btn-success btn-lg mb-1">
                Upload CV
              </button>
            </form>
            {% else %}
            <form enctype="multipart/form-data" method="post">
              {% csrf_token %}
              <input type="file" name="cv" />
              <button type="submit" class="btn btn-success btn-lg mb-1">
                Edit CV
              </button>
            </form>
            {% endif %}
            <hr />
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<section>
  <h1 style="text-align: center; padding: 50px">Company Details</h1>
  <div class="container mx-auto mt-4">
    <div class="row">
      {% for company in company_list %}
      <div class="col-md-4 mb-4">
        <div class="card" style="width: 18rem">
          <img
            src="https://i.imgur.com/ZTkt4I5.jpg"
            class="card-img-top"
            alt="..."
          />
          <div class="card-body">
            <h5 class="card-title">{{ company.c_name }}</h5>
            <h6 class="card-subtitle mb-2 text-muted">{{ company.c_email }}</h6>
            <p class="card-text">
              Profile: {{ company.c_profile }}
              <br>
              Contact Number: {{ company.c_contactno }}
              <br>
              Status: {% if student.student in company.students.all %}Applied{% else %}Not Applied{% endif %}
            </p>
            <form method="post">
              {% csrf_token %}
              <input type="hidden" value={{ company.c_name }} name="c_apply" />
              <button type="submit" class="btn btn-success btn-lg mb-1">
                Apply
              </button>
            </form>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>
<section>
  <h1 style="text-align: center; padding: 50px">Alumni Details</h1>
  <div class="container mx-auto mt-4">
    <div class="row">
      {% for alumni in alumni_list %}
      <div class="col-md-4 mb-4">
        <div class="card" style="width: 18rem">
          <img
            src="https://i.imgur.com/ZTkt4I5.jpg"
            class="card-img-top"
            alt="..."
          />
          <div class="card-body">
            <h5 class="card-title">{{ alumni.a_name }}</h5>
            <h6 class="card-subtitle mb-2 text-muted">{{ alumni.a_email }}</h6>
            <p class="card-text">
              Profile: {{ alumni.a_profile }}
              <br>
              Contact Number: {{ alumni.a_contactno }}
              <br>
              Status: {% if student.student in company.students.all %}Submitted for Review{% else %}None{% endif %}
            </p>
            <form method="post">
              {% csrf_token %}
              <input type="hidden" value={{ alumni }} name="a_apply" />
              <button type="submit" class="btn btn-success btn-lg mb-1">
                Submit for Review
              </button>
            </form>
            {% if alumni == feedback.alumni %}
            <h3>Feedback:</h3>
            <br>
            <textarea cols="30" rows="10">{{feedback.text}}</textarea>
            {% endif %}
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>
{% endif %}
{% endblock %}
